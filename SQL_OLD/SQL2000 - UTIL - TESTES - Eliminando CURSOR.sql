----------------------------------------------------------------------------------------------------------------------------------------------------
--PREPARA TABELAS
----------------------------------------------------------------------------------------------------------------------------------------------------
IF OBJECT_ID('tempdb..#temp') IS NOT NULL
	DROP TABLE #temp

CREATE TABLE #temp 
( 
	Id INT IDENTITY(1,1), 
	Nome VARCHAR(10) 
)
INSERT #temp (Nome)
VALUES 
	 ('Rodrigo')
	,('Rafael')
	,('Wanderley')

----------------------------------------------------------------------------------------------------------------------------------------------------
--TÉCNICA WHILE
----------------------------------------------------------------------------------------------------------------------------------------------------
DECLARE @table TABLE
	(Id int)

INSERT INTO @table
SELECT Id FROM #temp Order by Nome

DECLARE @Id int

WHILE (SELECT count(*) FROM @table) > 0
BEGIN
	SELECT TOP 1 @Id = Id FROM @table
	
	UPDATE #temp SET Nome = UPPER(Nome) WHERE Id = @Id
	
	DELETE FROM @table WHERE Id = @Id
END

SELECT * FROM #temp

----------------------------------------------------------------------------------------------------------------------------------------------------
--CONCATENAÇÃO VALORES
----------------------------------------------------------------------------------------------------------------------------------------------------
DECLARE @RETURN VARCHAR(MAX) 

SELECT @RETURN = COALESCE(@RETURN + ', ','') + COALESCE(Nome,'')
FROM #temp 

SELECT @RETURN

DROP TABLE #temp 

----------------------------------------------------------------------------------------------------------------------------------------------------
